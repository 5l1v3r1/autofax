<!-- Creator     : groff version 1.22.2 -->
<!-- CreationDate: Mon May 22 23:09:06 2017 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>man</title>

</head>
<body>

<h1 align="center">man</h1>

<a href="#NAME_D">NAME</a><br>
<a href="#SYNOPSIS_D">SYNOPSIS</a><br>
<a href="#SHORT DESCRIPTION_D">SHORT DESCRIPTION</a><br>
<a href="#INSTALLATION_D">INSTALLATION</a><br>
<a href="#USAGE_D">USAGE</a><br>
<a href="#OPTIONS_D">OPTIONS</a><br>
<a href="#FUNCTIONALITY_D">FUNCTIONALITY</a><br>
<a href="#PRECONDITIONS_D">PRECONDITIONS</a><br>
<a href="#AUTOMATICALLY INSTALLED SOFTWARE PACKAGES_D">AUTOMATICALLY INSTALLED SOFTWARE PACKAGES</a><br>
<a href="#IMPLICATIONS_D">IMPLICATIONS</a><br>
<a href="#UNINSTALLING_D">UNINSTALLING</a><br>
<a href="#ERRORS_D">ERRORS</a><br>
<a href="#LIABILITY_D">LIABILITY</a><br>
<a href="#AUTHOR_D">AUTHOR</a><br>

<hr>


<h2>NAME
<a name="NAME_D"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>autofax</b>
&minus; fax server functionality: induces automatic fax
transmission of files, naming of received faxes and logging
of all of them in a database <br>
(manpage-Hilfe in deutsch verf&uuml;gbar: &rsquo;man
autofax&rsquo; oder &rsquo;man -Lde autofax&rsquo;)</p>

<h2>SYNOPSIS
<a name="SYNOPSIS_D"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>autofax
[-&lt;shortopt&gt;|--&lt;longopt&gt; [&lt;supplement&gt;]]
...</b></p>

<h2>SHORT DESCRIPTION
<a name="SHORT DESCRIPTION_D"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em"><b>autofax</b>
offers quasi the functionality of fax server, which can be
useful for some also behind a fast data line. <b><br>
autofax</b> is a command line program to remit files of a
certain directory automatically to <b>hylafax</b> (in case a
linux-compatible modem is installed) and/or <b>capisuite</b>
(in case a fritzcard 2.0 or 2.1 is installed), if the fax
number is integrated in the file name correctly.
Furthermore, autofax holds the posted faxes in a mariadb
database. <br>
Additionally, received faxes from
<b>hylafax</b>/<b>capisuite</b> can be named automatically
with the sender&rsquo;s name, according to his fax number,
and stored. <br>
The usability within a network (may also be a windows
network with only one linux machine) is being accomplished
by automatic integration of all relevant directories into a
samba server. It could be complemented by a frontend for the
mariadb database.</p>

<h2>INSTALLATION
<a name="INSTALLATION_D"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">First, please
read the chapters &rsquo;functionality&rsquo;,
&rsquo;preconditions&rsquo;,&rsquo;automatically installed
software packages&rsquo; and &rsquo;implications&rsquo;
below. Then, if connected to the internet, call (e.g. by
coying the line and pasting it into a terminal): <b><br>
N=autofax;P=${N}_inst.sh;cd ~;wget
https://raw.githubusercontent.com/libelle17/$N/master/install.sh
-O$P&&sh $P</b> <br>
At last, call: <b><br>
autofax</b> <br>
and answer some questions of the program. <br>
The first execution and the first processing of a
sent/received fax with each of hylafax and/or capisuite may
take some time and need some additional input,
respectively.</p>

<h2>USAGE
<a name="USAGE_D"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Ideally, the
program should have installed itsself after a single call
(see above) in a self-running way. <br>
Then a directory e.g. &rsquo;<b>tobefaxed</b>&rsquo; exists,
in which e.g. users in a network (e.g. via the above
mentioned samba share) can deposit files to be faxed, e.g.
<br>
&quot;<b>Medical report on Frank Ill to Dr. Healthy and
Frank Ill to fax 099 987654321 and 088
887654321.doc</b>&quot; (it could also be e.g. an *.xls, a
*.jpg, a *.tif, a *.txt, a *pdf file; the section &rsquo; to
Dr. Healthy and Frank Ill&rsquo; is optional for the later
allocation of the fax number(s) in the database, it may also
be obmitted). <br>
When <b>autofax</b> is called for the next time (per default
2 minutes), the above mentioned example file will initially
be copied and renamed into <br>
&quot;<b>Medical report on Frank Ill to Dr. Healthy to fax
099 987654321.doc</b>&quot; and <br>
&quot;<b>Medical report on Frank Ill to Frank Ill to fax 088
887654321.doc</b>&quot; and converted into the pdf-files
<br>
&quot;<b>Medical report on Frank Ill to Dr. Healthy to fax
099 987654321.pdf</b>&quot; and <br>
&quot;<b>Medical report on Frank Ill to Frank Ill to fax 088
887654321.pdf</b>&quot;. <br>
Those are subsequently being relayed to <b>hylafax</b> or
<b>Capisuite</b> and from there sent. <br>
Simultaneously they are being moved from
&rsquo;<b>tobefaxed</b>&rsquo; to the waiting directory,
e.g. &rsquo;<b>waitingfaxes</b>&rsquo; and recorded in the
spool table <b>spooltab</b>. <br>
At each call, autofax checks the status of <b>hylafax</b>
and/or <b>Capisuite</b>. The Finishing of a fax process
there causes autofax to move the source files (here the
above mentioned .doc- and .pdf-files) from the waiting
directory to one or several archive directories or a
directory for failed faxes and to move their database record
from &rsquo;<b>spooltab</b>&rsquo; to the archive table
&rsquo;<b>outa</b>&rsquo;. <br>
Further on, incoming faxes via <b>hylafax</b> or
<b>Capisuite</b> are being transmitted to an incoming
directory and if applicable named including the
sender&rsquo;s name. To this purpose, customizeable sql
commands are being used, if specified. <br>
Depending on operating system, accessability and preferences
the users thus could look up the status of their faxes in
the above mentioned directories, in the database tables or
by calling &rsquo;<b>autofax&rsquo;, &rsquo;autofax
-lista</b>&rsquo;, &rsquo;<b>autofax -listf</b>&rsquo; or
&rsquo;<b>autofax -listi</b>&rsquo;.</p>

<h2>OPTIONS
<a name="OPTIONS_D"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">With
&rsquo;<b>autofax -?</b>&rsquo; or &rsquo;<b>autofax
-h</b>&rsquo;, the important and with &rsquo;<b>autofax
-lh</b>&rsquo;, all command line options can be seen. Some
options (e.g. the sql commands) cannot bei set via the
command line, but only via the configuration file, which can
be edited directly or interactively by &rsquo;<b>autofax
-rf</b>&rsquo;. <b><br>
Fehlender Parameter &lt;string&gt; zu -sp oder --sprache!
<br>
Gebrauch: autofax [-&lt;opt&gt;|--&lt;longopt&gt;
[&lt;content&gt;]] ... <br>
Faxt Dateien aus Verzeichns &lt;pfad&gt;, die &rsquo;an Fax
&lt;faxnr&gt;&rsquo; enthalten und durch soffice in pdf
konvertierbar sind <br>
und traegt sie in MariaDB-Datenbank &rsquo;autofax&rsquo;
(Tabellen: &lsquo;outa&lsquo;,&lsquo;spool&lsquo;) ein. <br>
Optionen, die nicht gespeichert werden: <br>
-w, --wortreich</b>: Bildschirmausgabe gespraechiger <b><br>
-l, --log</b>: protokolliert ausfuehrlich in Datei
&rsquo;<b>/var/log/autofax.log</b>&rsquo; (sonst knapper)
<b><br>
-ldn, --logdateineu</b>: logdatei vorher loeschen <b><br>
-kd, --konfdatei &lt;string&gt;</b>: verwendet
Konfigurationsdatei &lt;string&gt; anstatt &rsquo;&rsquo;
<b><br>
-sqlw, --sql-wortreich</b>: Bildschirmausgabe mit
SQL-Befehlen <b><br>
-rf, --rueckfragen</b>: alle Parameter werden abgefragt
(darunter einige hier nicht gezeigten) <b><br>
-krf, --keinerueckfragen</b>: keine Rueckfragen, z.B.
f&uuml;r Aufruf aus cron <b><br>
-loef, --loeschefax</b>: ein Fax nach Rueckfrage loeschen
<b><br>
-loew, --loeschewaise</b>: Eintraege aus
&lsquo;<b>spool</b>&lsquo; loeschen, zu denen keine Datei im
Wartevz.und kein Capi- oder Hylafax nachweisbar ist <b><br>
-loea, --loescheallew</b>: alle wartenden Faxe und
zugehoerige Eintraege aus &lsquo;<b>spool</b>&lsquo;
loeschen <b><br>
-erneut, --erneutempf</b>: empfangenes Fax erneut
bereitstellen <b><br>
-uml, --umleiten</b>: ausgehendes Fax vorzeitig auf zweitem
Weg schicken <b><br>
-kez, --korrerfolgszeichen</b>: in der Datenbanktabelle
&lsquo;<b>outa</b>&lsquo; wird das Erfolgszeichen korrigiert
<b><br>
-bwv, --bereinigewv</b>: Dateien aus Warteverzeichnis gegen
&lsquo;<b>outa</b>&lsquo; pruefen und ggf. verschieben
<b><br>
-st, --stop</b>: autofax anhalten <b><br>
-lista, --listausg</b>: listet Datensaetze aus
&lsquo;<b>outa</b>&lsquo; mit Erfolgskennzeichen auf <b><br>
-listf, --listfehlgeschl</b>: listet Datensaetze aus
&lsquo;<b>outa</b>&lsquo; ohne Erfolgskennzeichen auf
<b><br>
-liste, --listeing</b>: listet Datensaetze aus
&lsquo;<b>inca</b>&lsquo; auf <b><br>
-listw, --listwartende</b>: listet wartende Faxe auf <b><br>
-s, --suche &lt;string&gt;</b>: Suche in verarbeiteten Faxen
nach &lt;string&gt;: &rsquo;&rsquo; <b><br>
-n, --dszahl &lt;zahl&gt;</b>: Zahl der aufzulistenden
Datensaetze = &lt;zahl&gt; statt &rsquo;<b>30</b>&rsquo;
<b><br>
-info, --version</b>: Zeigt die Programmversion an <b><br>
-vi, --vi</b>: Konfigurations- u.Logdatei bearbeiten/sehen
(beenden mit &rsquo;:qa&rsquo;) <b><br>
-vc, --vc</b>: Capisuite-Konfigurationsdateien bearbeiten
(beenden mit &rsquo;:qa&rsquo;) <b><br>
-vh, --vh</b>: Hylafax-Modem-Konfigurationsdatei bearbeiten
(beenden mit &rsquo;:qa&rsquo;) <b><br>
-vs, --vs</b>: Quelldateien bearbeiten (beenden mit
&rsquo;:qa&rsquo;) <b><br>
-h, --hilfe</b>: Erkl&auml;rung h&auml;ufiger
Optionen <b><br>
-lh, --langhilfe</b>: Erkl&auml;rung aller Optionen
<b><br>
Optionen z.Speich. i.Konfigur&rsquo;datei (vorausg.
&rsquo;1&rsquo;=doch nicht speichern,
&rsquo;no&rsquo;=Gegenteil, z.B.
&rsquo;-noocra&rsquo;,&rsquo;-1noocri&rsquo;): <br>
-sp, --sprache &lt;string&gt;</b>:
Language/Sprache/Lingue/Lingua
[<b>d</b>eutsch,<b>e</b>nglisch] &rsquo;<b>d</b>&rsquo;
<b><br>
-lvz, --logvz &lt;pfad&gt;</b>: waehlt als Logverzeichnis
&lt;pfad&gt;, derzeit &rsquo;<b>/var/log</b>&rsquo; <b><br>
-ld, --logdname &lt;string&gt;</b>: logdatei &lt;string&gt;
(im Pfad &rsquo;<b>/var/log</b>&rsquo;) wird verwendet
anstatt &rsquo;<b>autofax.log</b>&rsquo; <b><br>
-zvz, --zufaxenvz &lt;pfad&gt;</b>: faxt die Dateien aus
&lt;pfad&gt; anstatt
&rsquo;<b>/var/autofax/zufaxen</b>&rsquo; <b><br>
-wvz, --wartevz &lt;pfad&gt;</b>: Dateien warten in
&lt;pfad&gt; anstatt
&rsquo;<b>/var/autofax/warteauffax</b>&rsquo; <b><br>
-nvz, --nichtgefaxtvz &lt;pfad&gt;</b>: Gescheiterte Faxe
werden hier gesammelt anstatt in
&rsquo;<b>/var/autofax/nichtgefaxt</b>&rsquo; <b><br>
-evz, --empfvz &lt;pfad&gt;</b>: Empfangsverzeichnis fuer
Faxempfang &rsquo;<b>/var/autofax/empfvz</b>&rsquo; <b><br>
-cm, --cronminuten &lt;zahl&gt;</b>: alle wieviel Minuten
soll <b>autofax</b> ueber crontab aufgerufen werden (0=gar
nicht), anstatt &rsquo;<b>2</b>&rsquo; <b><br>
-capi, --obcapi</b>: Capisuite verwenden <b>oder nicht <br>
-hyla, --obhyla</b>: Hylafax verwenden <b>oder nicht <br>
-cz, --capizuerst</b>: versuche faxe zuerst ueber Capisuite
wegzuschicken <b>oder nicht <br>
-hz, --hylazuerst</b>: versuche faxe zuerst ueber hylafax
wegzuschicken <b>oder nicht <br>
-mod, --hmodem &lt;string&gt;</b>: Fuer Hylafax verwendetes
Modem, anstatt &rsquo;&rsquo; <b><br>
-mc, --maxcapiv &lt;zahl&gt;</b>: nach &lt;zahl&gt;
Versuchen Capisuite wird Hylafax versucht, anstatt nach
&rsquo;<b>3</b>&rsquo; <b><br>
-mh, --maxhylav &lt;zahl&gt;</b>: nach &lt;zahl&gt;
Versuchen Hylafax wird Capisuite versucht, anstatt nach
&rsquo;<b>3</b>&rsquo; <b><br>
-cuser, --cuser &lt;string&gt;</b>: verwendet fuer Capisuite
und/oder Samba den Linux-Benutzer &lt;string&gt; anstatt
&rsquo;&rsquo; <b><br>
-ckzl, --cklingelzahl &lt;zahl&gt;</b>: Zahl der
Klingeltoene, bis Capisuite den Anruf annimmt, anstatt
&rsquo;<b>1</b>&rsquo; <b><br>
-hkzl, --hklingelzahl &lt;zahl&gt;</b>: Zahl der
Klingeltoene, bis Hylafax den Anruf annimmt, anstatt
&rsquo;<b>2</b>&rsquo; <b><br>
-hmw, --hmaxwahlvers &lt;zahl&gt;</b>: Zahl der Wahlversuche
in Hylafax, anstatt &rsquo;<b>11</b>&rsquo; <b><br>
-gz, --gleichziel</b>: Faxe werden auch ohne Faxerfolg ins
Zielverzeichnis kopiert <b>oder nicht <br>
-ocre, --ocre</b>: Text aus empfangenen Faxen wird ermittelt
<b>oder nicht <br>
-ocra, --ocra</b>: Text aus gesandten Bildern wird ermittelt
<b>oder nicht <br>
-afs, --anfaxstr &lt;string&gt;</b>: faxnr wird hinter
&lt;string&gt; erwartet statt hinter &rsquo;<b>an
Fax</b>&rsquo; <b><br>
-acfs, --ancfaxstr &lt;string&gt;</b>: faxnr fuer primaer
Capisuite wird hinter &lt;string&gt; erwartet statt hinter
&rsquo;<b>an cFax</b>&rsquo; <b><br>
-ahfs, --anhfaxstr &lt;string&gt;</b>: faxnr fuer primaer
hylafax wird hinter &lt;string&gt; erwartet statt hinter
&rsquo;<b>an hFax</b>&rsquo; <b><br>
-as, --anstr &lt;string&gt;</b>: Adressatenname wird hinter
&lt;string&gt; erwartet statt hinter &rsquo; <b>an</b>
&rsquo; <b><br>
-us, --undstr &lt;string&gt;</b>: Trennstring &lt;string&gt;
fuer mehrere Adressaten/Telefonnummern statt
&rsquo;<b>und</b>&rsquo; <b><br>
-host, --host &lt;string&gt;</b>: verwendet die Datenbank
auf Host &lt;string&gt; anstatt auf
&rsquo;<b>localhost</b>&rsquo; <b><br>
-muser, --muser &lt;string&gt;</b>: verwendet fuer
MySQL/MariaDB den Benutzer &lt;string&gt; anstatt
&rsquo;<b>user</b>&rsquo; <b><br>
-mpwd, --mpwd &lt;string&gt;</b>: verwendet fuer
MySQL/MariaDB das Passwort &lt;string&gt; <b><br>
-db, --datenbank &lt;string&gt;</b>: verwendet die Datenbank
&lt;string&gt; anstatt &rsquo;<b>autofax</b>&rsquo;</p>

<h2>FUNCTIONALITY
<a name="FUNCTIONALITY_D"></a>
</h2>


<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">1) The current hardware is being
checked.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">a) with the command
&rsquo;<b>lspci | grep -i isdn</b>&rsquo; for a fritz
card.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">b) with the command
&rsquo;<b>stty -F</b>&rsquo; for a fax modem.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">2) The fax configuration file
<b>fax.conf</b> of capisuite is read, if it exists</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">3) Further defaults from the
program code are assigned which can be overloaded by the
autofax configuration file (see 4), command line arguments
or anwers to questions (see 5).</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">4) Defaults are loaded from the
configuration file, if it exists (per default
<b>autofax.conf</b> in the same directory as <b>autofax</b>,
per default <b>/usr/local/sbin/autofax</b>))</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">5) Questions are asked, if
values are missing from the configuration file (see 4) or if
a command line option demands interacitivity.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">6) The directory of
<b>hylafax</b> is beeing determined
(<b>/var/spool/hylafax</b> or <b>/var/spool/fax</b>), if
hylafax is installed.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">7) Directories used by the users
for fax files to be sent, for waiting faxes, for fax files
already sent, for failed faxes and for received faxes are
being checked and created if needed. Thereby user defined
file name patterns can be respected to store successfully
sent faxes in different directories.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">8) The program inserts itsself
if wanted and necessary in root&rsquo;s <b>crontab</b> in
order to be called in adjustable intervals. To avoid this,
either &rsquo;<b>cronminut</b>&rsquo; can be set to
<b>0</b>, or the already generated autofax entry can be
commented out with a leading &rsquo;<b>#</b>&rsquo;.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">9) The program checks if all
user-relevant directories (see 7) are being included in
samba shares in <b>/etc/samba/smb.conf</b>; such are being
added if needed.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">10) Working of MariaDB is being
checked, if necessary it is being (installed and) started,
the database tables <b>spooltab</b> (for faxes just in
spool), <b>outa</b> (for sent and failed faxes) and
<b>inca</b> (for received faxes) are being checked and if
necessary created or amended.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">11) In case of the respective
command line options corrections in the contents of the
waiting directory or of the database tables are being
commited or their contents is being listed and then the
program is being finished.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">12) Otherwise, file in the
outgoing directory are being analysed. Each file with some
identifiable fax number(s) within its file name which is or
can be converted in/into pdf format will be moved to to
waiting directory and recorded in <b>spooltab</b>.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">If a file contains more than one
recepients and/or a conversion to pdf is necessary,
additional files are generated and the original file may be
renamed. If necessary, additional numbers near the end of
the file name(s) may be added in order not to conflict with
any other file name in one of the directories mentioned in
7).</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">If more files have been
generated, the successive movements and recordings are being
carried out with all of them.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">13) Depending on the
configuration the functionaliy of <b>hylafax</b> and/or
<b>capisuite</b> is being checked and if necessary and
possible restored (including by installation of those
programs; in case of a fritzcard 2.0 or a fax modem USR5637
an additional automatic configuration can/will be done).
Kernel modules for hylafax and/or capisuite are
automatically generated, also in case of a kernel
update.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">14) In case of respective
command line options faxes are being deleted and the program
is finished.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">15) Otherwise the files which
have been recorded under 12) in <b>spooltab</b> are being
forwarded to <b>hylafax</b> or <b>capisuite</b> and this is
being protocolled in <b>spooltab</b>.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">16) All faxes which are recorded
in <b>spooltab</b> as waiting are being checked in
<b>hylafax</b>/<b>capisuite</b> as to their status which is
being updated in <b>spooltab</b> (number of tries
hitherto).</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">If hylafax and capisuite are
working simultaneously and a prespecified number of send
tries has been reached without success in the programs of
the first preference of those two, the fax is additionally
forwarded to the second of the two programs.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">If the fax transmission is
finished (with/without success), the file is being moved
from the waiting directory to the respective directory for
sent faxes or for failed faxes, optionally modified by ocr
via ocrmypdf (if a young enough python3 &gt; 3.5 is
installed), and the database entry is being transferred from
<b>spooltab</b> to <b>outa</b>.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">The status of the mentioned
faxes is being displayed.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">17) If additional faxes in the
spool of hylafax/capisuite are detected which are not
created via autofax, they are displayed. In intervals they
will be integrated into the autofax database (without the
not available information on the original file name).</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">18) Via
<b>hylafax</b>/<b>capisuite</b> received faxes are copied to
a receiving directory and there named with the name of the
sender, if possible, by means of their fax number which is
being looked up using a predefineable number of
predefineable sql commands, which are applied one after
another until the fax number is found.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">Such sql commands shall deliver
(at least) 2 fields (with a user defined sense), whose
contents, separated by a comma, will be used by autofax to
name the received faxes. Before applied, within the sql
commands the string &rsquo;&&faxnr&&&rsquo;
will be replaced by the current fax number. Example:</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">select concat(haname,&rsquo;,
&rsquo;,ort,&rsquo;, &rsquo;,kvnu) name, zulg from
kvaerzte.hae where
concat(if(mid(fax1k,1,1)=&rsquo;0&rsquo;,&rsquo;&rsquo;,&rsquo;08131&rsquo;),
replace(replace(replace(replace(fax1k,&rsquo;
&rsquo;,&rsquo;&rsquo;),&rsquo;-&rsquo;,&rsquo;&rsquo;),&rsquo;/&rsquo;,&rsquo;&rsquo;),&rsquo;&acute;&rsquo;,&rsquo;&rsquo;))
= &rsquo;&&faxnr&&&rsquo;</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">
</td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">If more sql commands are
specified and one of them does not give a result, the next
one will be tried.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">Optionally, the received faxes
are subjected to ocr via a call of ocrmypdf.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">19) The configuration file is
being written, if necessary.</p></td></tr>
</table>

<h2>PRECONDITIONS
<a name="PRECONDITIONS_D"></a>
</h2>



<p style="margin-left:11%; margin-top: 1em"><b>Hardware</b>:
Computer with a fritzcard 2.0 or 2.1 or/and a linux
compatible fax modem; in the current version, a US Robotics
modem USR5637 and one of the below mentioned linux
distributions are needed for an automatic installation (by
answering some questions). In case of a concurrent use of a
fritzcard and a modem, the program can optimize the security
of transmission of a fax. <b><br>
Software</b>: The program was adjusted to an installation of
Opensuse &gt;= 42.1, Debian &gt;= 8.60, Ubuntu &gt;= 16.04,
Mint &gt;= 18 or Fedora &gt;= 24 with standard options.
System D has to be installed, i.e., &quot;systemctl&quot;
has to run. One of the packet managers rpm or dpkg and apt,
dnf, yum or zypper has to be installed, respectively, as is
the case per default in the mentioned linux distributions.
Uninstalling of the programs added by autofax by <b>make
uninstall</b> works currently only with the english and the
german versions of the packet manager.</p>

<h2>AUTOMATICALLY INSTALLED SOFTWARE PACKAGES
<a name="AUTOMATICALLY INSTALLED SOFTWARE PACKAGES_D"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">(for this
purpose, depending on the distribution, zypper, apt(-get),
dnf or yum are used).</p>


<p style="margin-left:11%; margin-top: 1em"><b>makefile:</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">gcc V.6, g++ V.6, groff,
libmysqlclient-dev(el), libtiff-dev(el) (in case of version
4.0.7 with a slight modification, see Makefile)</p></td></tr>
</table>

<p style="margin-left:15%;"><b>autofax:</b></p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">boost, boost-devel, cron,
ghostscript, imagemagick, libreoffice-common,
libreoffice-base, mariadb-server, policycoreutils,
policycoreutils-python-utils, poppler-tools, samba,
sfftobmp, (in debian-derivates, for mariadb, additionally:
apt-transport-https)</p> </td></tr>
</table>

<p style="margin-left:15%;">in case <b>capisuite</b> shall
be used:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">capisuite, capiutils,
capi4linux, fcpci-3.10.0, gcc-4.8, g++-4.8, kernel-source
(linux-source), libcapi20-2, libcapi20-3, libxslt-tools,
linux-headers-$(uname -r), python-devel, (in fedora,
additionally: kernel-modules-extra),</p></td></tr>
</table>

<p style="margin-left:15%;">in case <b>hylafax</b> shall be
used:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">hylafax+, hylafax+-client,
sendmail, tiff (in case of version 4.0.7 with a slight
modification, see Makefile)</p></td></tr>
</table>

<p style="margin-left:15%;">in case <b>ocr</b> shall be
used:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">ffmpeg, ffmpeg-devel,
ffmpeg-compat, gcc, libavformat-devel, libffi-devel,
ocrmypdf, python3-devel, python3-pip, python3-setuptools,
rpmfusion, qpdf, redhat-rpm-config, tesseract-ocr, unpaper,
and via &rsquo;python3 pip&rsquo;: cryptography, cffi,
image, M2Crypto, ocrmypdf, PyPDF2, reportlab, ruffus.</p></td></tr>
</table>

<p style="margin-left:15%;">in case You want to work on the
source files with &rsquo;sh viall&rsquo;:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="4%">


<p style="margin-top: 1em">vim</p></td>
<td width="85%">
</td></tr>
</table>

<p style="margin-left:15%;">All those installations may
include dependent programs. <br>
If You don&rsquo;t want one of those programs or want to
keep an older version of one, You may not install autofax or
use the respective program parts.</p>

<h2>IMPLICATIONS
<a name="IMPLICATIONS_D"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The program has
to take the following measures for its neat function:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">1) In debian, in the file
/etc/apt/sources.list a dvd-entry can be moved behind the
standard online repositories.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">2) Sudo (is missing per default
in debian) will be installed if needed.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">The current linux user, if not
already contained, will be entered into an administrator
group mentioned in /etc/sudoers, because he has to call
&quot;sudo&quot;.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">3) &rsquo;GNU make&rsquo; will
be installed if not present, automatically by calling
&rsquo;sh install.sh&rsquo; or &rsquo;configure&rsquo;.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">4) Installation of
<b>hylafax+</b>, in case a modem is connected and hylafax+
is not installed. If necessary configuration of hylafax+ by
calling &rsquo;<b>faxsetup -nointeracitve</b>&rsquo;, by
editing the configuration files <b>config</b> and
<b>config.*</b> (e.g. <b>config.ttyACM0</b>) in the hylafax
configuration directory (default e.g.
<b>/var/spool/hylafax/etc</b>).</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">5) Installation of
<b>capisuite</b>, in case a fritzcard is inserted and
capisuite is not installed. If necessary configuration of
<b>/etc/capisuite/capisuite.conf</b> and
<b>/etc/capisuite/fax.conf</b>. If necessary edition of the
python-script for received faxes (default e.g.
<b>/usr/lib64/capisuite/incoming.py</b>) in order to
determine the rings before answer, creation and edition of
the files
&rsquo;<b>/etc/udev/rules.d/46-FKN_isdn_capi.rules</b>&rsquo;,
&rsquo;<b>/etc/modprobe.d/50-blacklist.conf</b>&rsquo;.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">6) Installation of services:</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">a) in systemd (in the directory
/usr/lib/systemd/system or /lib/systemd/system),
especially:</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>hylafax-faxq.service</b>,
<b>hylafax-hfaxd.service</b>,
<b>hylafax-faxgetty-....service</b> (e.g.
<b>hylafax-faxgetty-ttyACM0</b>),</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em"><b>capisuite.service</b>,</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">b) Moving of existing service
files from the directory /etc/init.d to a newly created
directory /etc/ausrangiert (&quot;discarded&quot;):
<b>hylafax</b>, <b>capisuite</b></p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">c) In case <b>selinux</b> is
active (as per default in fedora), it impedes per default
hylafax; in this case, a module for selinux is silently
arranged in order to allow running hylafax-hfaxd. Furtheron,
up to the possible construction of a better fitting
solution, the domain &rsquo;getty&rsquo; has to be
deactivated with the command &rsquo;<b>semanage permissive
-a getty_t</b>&rsquo; in order to be able to receive
faxes.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">7) Creation of a logfile, per
default <b>/var/log/autofax.log</b>.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">8) if necessary creation and
making accessible of the configurable <b>directories</b> for
faxes to be sent, waiting, finished and failed.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">9) if necessary creation and
making accessible of the configuration file
<b>autofax.conf</b> in the same directory where the program
is located by itsself (default:
<b>/usr/local/sbin/autofax</b>).</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">10) Insertion of a line for the
periodic automatic program call in root&rsquo;s crontab</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">11) if necessary insertion of
sections for the directories mentioned under 8) in
/etc/samba/smb.conf, if necessary insertion of the program
user or (if root) the user chosen for the capisuite as samba
user. In case a Suse firewall is present, allow samba-server
for &quot;external zone&quot;. After calling autofax, the
directories mentioned in 8) should be readable via samba
within a local network and the directory for faxes to be
sent should also be writable.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">12) if necessary insertion of a
database in mariadb with a configurable name, creation and
modification of several tables and a procedure in this
database, if necessary insertion of a user with a
configurable name in mariadb for the management of those
tables.</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">13) With specific command line
options for autofax, faxes can be deleted, especially:</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">a) in hylafax by callinng
&rsquo;faxrm&rsquo;</p> </td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">b) in capisuite: by deleting
files like
/var/spool/capisuite/users/&lt;user&gt;/sendq/*.txt und
~/*.sff. In capisuite, an orphaned lock file
(/var/spool/capisuite/users/&lt;user&gt;/sendq/*.lock) can
be deleted, too.</p></td></tr>
<tr valign="top" align="left">
<td width="11%"></td>
<td width="89%">


<p style="margin-top: 1em">14) With a specific command line
option for autofax, an old received fax can be converted to
a pdf-File again.</p></td></tr>
</table>

<h2>UNINSTALLING
<a name="UNINSTALLING_D"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Change in a
terminal to the installation directory (for the same
installed user, it&rsquo;s <b>cd ~/autofax</b>, otherwise it
will be displayed by <b>autofax -info</b>). <br>
Call <b>make uninstall</b>. <br>
Then the installed <b>autofax</b> will be deleted and the
script <b>uninstallinv</b> will be executed in reverse order
which has been generated during the installation and
execution of autofax. <br>
Thereby additionally installed program packets, permissions,
samba shares and firewall exceptions are deleted. <br>
Configuration files, data, and system relevant programs like
libgcc and selinux will not be deleted. <br>
Error messages originate mostly in efforts to delete a
program already missing and can then be ignored.</p>

<h2>ERRORS
<a name="ERRORS_D"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Please report
any errors with the word &rsquo;autofax&rsquo; included in
the email headline. <br>
Please report as well, if different hard- or software yields
a requirement for a program modification.</p>

<h2>LIABILITY
<a name="LIABILITY_D"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">The program has
been written with the best aim and has been tested by the
author. <br>
Nevertheless the author cannot be liable for any damage
caused by the program.</p>

<h2>AUTHOR
<a name="AUTHOR_D"></a>
</h2>


<p style="margin-left:11%; margin-top: 1em">Gerald Schade
(geraldschade@gmx.de; www.diabdachau.de)</p>
<hr>
</body>
</html>
